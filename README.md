# 外卖订餐系统

一个完整的外卖订餐管理系统，包含管理端和用户端。

---

## 项目介绍

本项目是基于 **前后端分离** 架构的完整外卖订餐管理系统，包含管理员后台与用户前台两套独立应用，实现了从菜品管理、订单处理到用户下单、AI 客服的完整业务流程。

### 技术架构

```
┌────────────────────────────────────────────────────┐
│              前端 (Vue 3 + Vite)                     │
├─────────────────────────┬──────────────────────────┤
│   管理端 (Admin)        │   用户端 (User)           │
│   Port: 5173            │   Port: 5174             │
│   Element Plus 2.x      │   Element Plus 2.x       │
│   - 菜品管理            │   - 菜单浏览             │
│   - 分类管理            │   - 购物车               │
│   - 套餐管理            │   - 订单管理             │
│   - 订单管理            │   - 地址管理             │
│   - 数据看板            │   - AI 客服              │
└─────────────────────────┴──────────────────────────┘
                     ↓ HTTP/JSON API
┌────────────────────────────────────────────────────┐
│           后端 (Spring Boot 2.7.18)                │
│              Port: 8080                           │
│   - JWT + Session 双认证                          │
│   - MyBatis Plus 3.5.3.1 ORM                      │
│   - MySQL 8.0+ 数据库                             │
│   - DeepSeek AI API 集成                          │
│   - Knife4j API 文档                              │
└────────────────────────────────────────────────────┘
```

## 技术栈

### 前端
- **框架**：Vue 3
- **UI 组件库**：Element Plus
- **状态管理**：Pinia
- **路由**：Vue Router
- **HTTP 请求**：Axios
- **构建工具**：Vite
- **Node.js**：22.20.0
- **npm**：10.9.3

### 后端
- **Java**：OpenJDK 17.0.16
- **框架**：Spring Boot 2.7.18
- **ORM**：MyBatis Plus 3.5.3.1
- **数据库**：MySQL 9.4.0（兼容 MySQL 8）
- **权限认证**：Session（简单实现）
- **API 文档**：Knife4j
- **构建工具**：Maven 3.9.11

### 说明
- **认证方式**：Session + Cookie（管理端用户），Stateless JWT（API 调用）
- **密码加密**：MD5 加盐存储
- **实现原则**：功能完整、业务清晰、易于维护
- **AI 集成**：DeepSeek Chat API，支持流式响应和错误降级

## 项目结构

```
01_meal_order_system/
├── docs/                    # 📁 文档目录
│   ├── README.md           # 文档索引
│   ├── 数据库设计.md        # 数据库设计文档
│   ├── 架构设计.md          # 系统架构设计
│   ├── 需求分析.md          # 需求分析文档
│   ├── 系统测试.md          # 系统测试文档
│   └── 环境配置.md          # 环境配置文档
├── scripts/                 # 🚀 启动脚本目录（仅保留中文 BAT）
│   ├── README.md           # 脚本使用说明
│   ├── 初始化数据库.bat     # 初始化数据库
│   ├── 一键启动所有服务.bat # 同时启动后端/管理端/用户端
│   └── 停止所有服务.bat     # 停止所有服务
├── tests/                   # 🧪 自动化测试脚本（Python）
│   ├── README.md           # 测试说明
│   ├── 00_init/            # Task 00 测试
│   ├── 01_admin_login/     # Task 01 测试
│   └── ...                 # 其他任务测试
├── database/                # 数据库脚本
│   ├── init.sql            # 建表脚本
│   └── test_data.sql       # 测试数据
├── backend/                 # 后端 Spring Boot
│   ├── src/
│   ├── pom.xml
│   └── README.md
├── frontend-admin/          # 管理端前端 Vue 3
│   ├── src/
│   ├── package.json
│   └── README.md
├── frontend-user/           # 用户端前端 Vue 3
│   ├── src/
│   ├── package.json
│   └── README.md
└── README.md               # 项目说明（本文件）
```

## 功能模块（已完整实现）

### 管理端功能（5个主要模块）
| 模块 | 功能 | 完成度 |
|------|------|--------|
| 🔐 登录管理 | 管理员登录、权限验证、Session管理 | ✅ 100% |
| 📂 分类管理 | 分类增删改查、排序、状态管理 | ✅ 100% |
| 🍜 菜品管理 | 菜品增删改查、分类关联、图片上传、上下架 | ✅ 100% |
| 🎁 套餐管理 | 套餐增删改查、菜品组合、价格管理 | ✅ 100% |
| 📦 订单管理 | 订单列表、订单详情、状态变更、一键发货、订单删除 | ✅ 100% |

### 用户端功能（6个主要模块）
| 模块 | 功能 | 完成度 |
|------|------|--------|
| 👤 用户系统 | 注册、登录、找回密码、账户充值 | ✅ 100% |
| 📍 地址管理 | 地址增删改查、设置默认地址、地址检索 | ✅ 100% |
| 🍽️ 菜品展示 | 分类浏览、菜品列表、菜品详情、快速查看 | ✅ 100% |
| 🛒 购物车 | 添加商品、修改数量、删除商品、清空购物车 | ✅ 100% |
| 📋 订单管理 | 下单、订单列表、订单详情、确认收货、订单查询 | ✅ 100% |
| 🤖 AI 客服 | 智能客服、多轮对话、关键词匹配、错误降级 | ✅ 100% |

### 核心特性
- [x] AI 客服助手集成（DeepSeek API）
- [x] JWT 令牌认证
- [x] 密码加密存储
- [x] 错误处理和异常捕获
- [x] API 文档自动生成（Knife4j）
- [x] 跨域请求处理
- [x] 文件上传功能

## 快速开始

### 🚀 方式一：使用启动脚本（推荐）

项目提供了便捷的启动脚本，**推荐使用此方式**。

#### 首次使用

1. **初始化数据库**（仅首次需要）
   ```bash
   # 双击运行
   scripts\初始化数据库.bat
   ```

2. **一键启动所有服务**
   ```bash
   # 双击运行（推荐）
   scripts\一键启动所有服务.bat
   ```
   或使用 PowerShell：
   ```powershell
   .\scripts\一键启动所有服务.ps1
   ```
   
   这将同时启动：
   - 后端服务（端口 8080）
   - 管理端前端（端口 5173）
   - 用户端前端（端口 5174）

#### 脚本说明

项目目前统一使用3个批处理脚本（全中文命名、UTF-8）：

| 脚本 | 功能 |
|------|------|
| `初始化数据库.bat` | 一键创建数据库 + 通用测试数据，首次运行必做 |
| `一键启动所有服务.bat` | 同时启动后端（8080）、管理端（5173）、用户端（5174） |
| `停止所有服务.bat` | 杀死以上服务占用端口的进程，保证下次可启动 |

直接双击运行即可，无需其他脚本。详细用法请看 `scripts/README.md`。

> 📖 **详细脚本说明**：请查看 `scripts/README.md`

### 🔧 方式二：手动启动

#### 1. 数据库初始化

```bash
# 1. 创建数据库
mysql -u root -p
CREATE DATABASE meal_order_system CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

# 2. 执行初始化脚本
cd database
mysql -u root -p meal_order_system < init.sql
mysql -u root -p meal_order_system < test_data.sql
```

#### 2. 启动后端

```bash
cd backend

# 修改数据库配置 (src/main/resources/application.yml)
# 根据实际情况修改数据库连接信息

# 运行项目
mvn spring-boot:run

# 访问
# API: http://localhost:8080/api
# 文档: http://localhost:8080/api/doc.html
```

#### 3. 启动前端管理端

```bash
cd frontend-admin

# 安装依赖（首次需要）
npm install

# 运行项目
npm run dev

# 访问: http://localhost:5173
```

#### 4. 启动前端用户端

```bash
cd frontend-user

# 安装依赖（首次需要）
npm install

# 运行项目
npm run dev

# 访问: http://localhost:5174
```

### 📍 访问地址

启动成功后，可通过以下地址访问：

| 服务 | 地址 | 说明 |
|------|------|------|
| 管理端 | http://localhost:5173 | 管理员登录界面 |
| 用户端 | http://localhost:5174 | 用户登录界面 |
| 后端API | http://localhost:8080/api | REST API接口 |
| API文档 | http://localhost:8080/api/doc.html | Knife4j API文档 |

## 🤖 AI 客服助手功能

### 功能说明

项目集成了 **DeepSeek AI 客服助手**，为用户提供智能化的在线客服服务。

#### 特点
- ✅ **智能回复**：使用 DeepSeek Chat API 进行自然语言处理
- ✅ **中文支持**：完整的中文交互支持
- ✅ **容错机制**：API 失败时自动降级到本地关键词匹配回复
- ✅ **零配置**：API Key 已硬编码，无需环境变量配置
- ✅ **即开即用**：启动后立即可使用，无需额外配置

#### 使用场景
- 菜品咨询
- 订单问题
- 配送信息
- 通用问答

#### 访问方式
用户端右下角点击 **AI 客服** 按钮即可开启对话。

### 快速测试

如果想单独测试 AI 客服功能，可以使用提供的测试脚本：

```bash
cd tests

# 方式1：一键启动（推荐）
start_backend_and_test.bat

# 方式2：菜单式测试
run_chatbot_test.bat

# 方式3：快速聊天
start_interactive_chat.bat
```

### 技术细节
- **API 提供商**：DeepSeek
- **集成方式**：Spring Boot REST API + Vue 3 前端组件
- **模型**：deepseek-chat
- **超时设置**：30 秒

### 文档
详细的 AI 客服集成文档请参考：`docs/chatbot/` 目录

## 核心业务流程

### 订单完整流程
```
用户端                     后端                      管理端
  │                        │                        │
  ├─ 浏览菜品 ────────────>│                        │
  │                        │                        │
  ├─ 添加购物车 ─────────>│                        │
  │                        │                        │
  ├─ 提交订单 ────────────>│ (状态: 待确认)         │
  │                        │                        │
  │                        │                  <────┤ (订单提醒)
  │                        │                        │
  │                        │     (确认订单)        │
  │                        │  <──────────────────  │
  │                        │ (状态: 待发货)        │
  │                        │                        │
  │                        │     (一键发货)        │
  │                        │  <──────────────────  │
  │ (配送中) <────────────│ (状态: 配送中)        │
  │                        │                        │
  ├─ 确认收货 ────────────>│ (状态: 已完成)        │
  │                        │                        │
  └─ AI客服沟通 ─────────>│ <──────────────────── │
```

### AI 客服交互流程
```
用户                DeepSeek API          本地关键词库
 │                    │                      │
 ├─ 提问 ───────────> │                      │
 │                    │                      │
 │ (API可用)          │                      │
 │  <─── AI回复 ──────│                      │
 │                    │                      │
 │ (API失败)                                │
 │  <─── 降级回复 ──────────────────────── │
```

## 测试数据

### 默认账号

### 管理端
- 用户名：admin
- 密码：123456

### 用户端
- 用户名：user001
- 密码：123456


## 文档说明

### 📖 核心文档
- **数据库设计**：`docs/数据库设计.md` - 9张表设计
- **架构设计**：`docs/架构设计.md` - 系统架构设计
- **需求分析**：`docs/需求分析.md` - 详细需求说明
- **系统测试**：`docs/系统测试.md` - 系统测试文档
- **环境配置**：`docs/环境配置.md` - 开发环境配置

### 模块说明
- **前端管理端**：`frontend-admin/README.md`
- **前端用户端**：`frontend-user/README.md`
- **后端**：`backend/README.md`
- **数据库**：`database/README.md`
- **启动脚本**：`scripts/README.md`

## 环境要求

| 组件 | 版本要求 | 说明 |
|------|---------|------|
| JDK | 17+ | 后端开发环境 |
| Maven | 3.9+ | 后端构建工具 |
| Node.js | 22+ | 前端开发环境 |
| npm | 10+ | 前端包管理 |
| MySQL | 8.0+ | 数据库（兼容 MySQL 9） |
| Python | 3.8+ | 自动化测试脚本 |

## 注意事项

### 开发建议
1. 确保已安装所有必要环境组件
2. 确保 MySQL 服务已启动并正确配置
3. 前端跨域请求需配置 `withCredentials: true`
4. 后端使用 Session + Cookie 认证机制
5. 上传文件前确保目录权限正确
6. AI 客服 API Key 已内置，无需额外配置

### 故障排查
- **连接超时**：检查 MySQL 服务状态和防火墙设置
- **端口被占用**：使用 `停止所有服务.bat` 或手动 kill 进程
- **CORS 错误**：确认后端 WebMvcConfig 中的跨域配置
- **AI 客服无响应**：检查网络连接和 DeepSeek API 状态

### 详细文档
- **Windows 环境**：`docs/Windows环境配置.md` ⭐ 推荐
- **MacOS 环境**：`docs/环境配置.md`
- **数据库设计**：`database/README.md`
- **API 文档**：启动后访问 `http://localhost:8080/api/doc.html`

## 项目贡献

欢迎提交 Issue 和 Pull Request！

## 许可证

MIT License

## 作者

AshRW24

---

**最后更新**：2025-12-05
**最新版本**：1.0.0 (Full Stack Complete)
**功能完成度**：11/11 模块 ✅
