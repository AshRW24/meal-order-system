# 自动化测试目录说明

## 📁 目录组织规则

每个开发任务对应一个测试目录，目录命名规则：

```
tests/
├── 00_init/                       # Task 00: 项目初始化测试
├── 01_admin_login/                # Task 01: 管理员登录API测试
├── 02_admin_login_ui/             # Task 02: 管理端登录页面测试
├── 03_category_add/               # Task 03: 分类查询+新增测试
├── 04_category_update/            # Task 04: 分类编辑+删除测试
├── ...
├── chatbot_test.py                # 🤖 AI 客服交互测试脚本 (NEW!)
└── ...
```

**命名格式**: `任务编号_功能名称/`（编号从00开始，功能名称用下划线分隔）

---

## 🤖 AI 客服测试工具

### 快速开始

```bash
# 安装依赖
pip install requests

# 启动后端（另一个终端）
cd backend
mvn spring-boot:run

# 运行测试脚本（在 tests 目录）
python chatbot_test.py
```

### 三种使用模式

#### 1️⃣ 交互模式（推荐）
```bash
python chatbot_test.py
```
实时与 AI 客服对话，输入 'exit' 退出

#### 2️⃣ 自动化测试
```bash
python chatbot_test.py --test
```
运行预定义的 5 个测试用例

#### 3️⃣ 单条消息测试
```bash
python chatbot_test.py --message "你好"
```
测试单条消息的响应

### 示例对话

```
🤖 AI 客服:
   您好！👋 我是AI客服助手...

👤 您: 有什么菜品？
⏳ 等待 AI 回复...
🤖 AI 客服:
   我们平台上有丰富的菜品选择...

👤 您: exit
```

### 文档
详见: [chatbot_test.py 使用指南](#ai-客服测试脚本说明)

---

## 🧪 测试策略说明

### **测试工具要求**
- 使用Python语言编写测试脚本
- 使用requests库进行HTTP接口测试
- 可选使用pytest框架（推荐）

### **测试内容要求**
每个任务的测试脚本必须覆盖：
1. **成功场景** - 正常参数下的功能验证
2. **失败场景** - 异常参数或错误输入的处理验证
3. **边界场景** - 边界值测试（如需要）
4. **权限验证** - 未登录或无权限时的拦截验证

### **测试执行前提**
- 后端服务已启动（默认端口：8080）
- 前端服务已启动（如需测试UI）
- 数据库已初始化（存在测试数据）

---

## 📝 测试脚本要求

### **文件命名**
- 主测试文件：`test_功能名.py`
- 辅助工具文件：`utils.py`（如需要）
- 配置文件：`config.py`（如需要）

### **必须包含的测试项**
1. 接口调用成功验证
2. 返回数据格式验证
3. 业务逻辑正确性验证
4. 错误处理验证
5. Session/Cookie认证验证（如需要）

### **断言要求**
- HTTP状态码断言（如200、401、404等）
- 业务状态码断言（如code=1表示成功）
- 返回数据结构断言
- 关键字段值断言

---

## 🔄 测试执行流程

### **执行顺序**
1. 启动后端服务
2. 启动前端服务（如需要）
3. 运行对应任务的测试脚本
4. 查看测试结果（全部通过才能提交代码）
5. 如测试失败，修复代码后重新测试

### **运行方式说明**
- 可以直接使用Python解释器运行单个测试文件
- 推荐使用pytest运行整个测试目录
- 支持生成测试报告（HTML格式）

---

## ✅ 测试通过标准

**任务测试通过的条件**：
- 所有测试用例执行完成
- 所有断言全部通过
- 无异常或错误信息
- 输出明确的"测试通过"提示信息

**只有测试全部通过后，才能进行Git提交和分支合并**

---

## 📊 测试数据管理

### **测试数据准备**
- 管理员账号：username=admin, password=123456
- 用户测试账号：需要在测试中自动注册或预先创建
- 测试分类、菜品数据：在测试中动态创建和清理

### **数据清理策略**
- 每次测试后清理创建的测试数据（推荐）
- 或使用专门的测试数据库（可选）

---

## 🐛 测试失败处理

**测试失败时的排查步骤**：
1. 检查后端服务是否正常启动
2. 检查数据库连接是否正常
3. 查看后端日志定位错误
4. 检查请求参数是否正确
5. 验证Session/Cookie是否正确传递
6. 修复问题后重新运行测试

---

**创建时间**: 2025-11-01
**维护说明**: 每完成一个任务，需在对应目录下创建测试脚本
